<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0,minimal-ui:ios">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CCmIT 中传环球（北京）新媒体科技有限公司</title>
    <link rel="stylesheet" href="../../css/bootstrap.css">
    <link rel="stylesheet" href="../../css/comm.css">
    <link rel="stylesheet" href="../../css/header.css">
    <link rel="stylesheet" href="../../css/user.css">
    <link rel="shortcut icon" href="../favicon.ico" />
    <script src="../../js/jquery.min.js"></script>
    <script src="../../js/popper.min.js"></script>
    <script src="../../js/bootstrap.min.js"></script>
</head>

<body>
    <header>
        <div class="container-fluid">
            <div class="navbar navbar-expand-md navbar-light py-lg-0">
                <!-- 网站Logo -->
                <div>
                    <img class="mr-2" src="../../img/blogo.png" alt="">
                    <span class="i d-lg-inline d-none"><small>中传环球（北京）新媒体科技有限公司</small></span>
                </div>
                <!-- 小屏下出现的折叠按钮 -->
                <button class="navbar-toggler" data-target="#content" data-toggle="collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <!-- 折叠的导航 -->
                <div id="content" class="navbar-collapse collapse justify-content-end">
                    <ul class="navbar-nav">
                        <li class="nav-item"><a href="../index.html" class="nav-link text-dark">网站首页
                                <small class="d-none text-center">Home</small></a>
                        </li>
                        <li class="nav-item dropdown text-md-center"><a data-toggle="dropdown"
                                href="../aboutus/about.html" class="nav-link text-dark">关于我们
                                <small class="d-none text-center">About US</small></a>
                            <ul class="dropdown-menu p-0">
                                <li class=" dropdown-item"><a class=" nav-link text-light"
                                        href="../aboutus/about.html">公司介绍</a></li>
                                <li class=" dropdown-item"><a class=" nav-link text-light"
                                        href="../aboutus/aboutln.html">文化理念</a></li>
                                <li class=" dropdown-item"><a class=" nav-link text-light"
                                        href="../aboutus/join.html">加入我们</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown text-md-center"><a data-toggle="dropdown"
                                href="../solution/media.html" class="nav-link text-dark">解决方案
                                <small class="d-none text-center">Solution</small>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="dropdown-item"><a href="../solution/media.html"
                                        class="nav-link text-light">融媒体平台</a></li>
                                <li class="dropdown-item"><a href="../solution/data.html"
                                        class="nav-link text-light">数据服务</a></li>
                                <li class="dropdown-item"><a href="../solution/culture.html"
                                        class="nav-link text-light">智慧文化</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown text-md-center"><a data-toggle="dropdown"
                                href="../whdata/industry.html" class="nav-link text-dark">数据服务
                                <small class="d-none text-center">Service</small>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="dropdown-item"><a href="../whdata/industry.html"
                                        class="nav-link text-light">产业数据</a></li>
                                <li class="dropdown-item"><a href="../whdata/basics.html"
                                        class="nav-link text-light">基础数据</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown text-md-center"><a data-toggle="dropdown"
                                href="../zccloud/enter.html" class="nav-link text-dark">中传云服务
                                <small class="d-none text-center">Cloud</small>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="dropdown-item"><a href="../zccloud/enter.html"
                                        class="nav-link text-light">入驻服务</a></li>
                                <li class="dropdown-item"><a href="../zccloud/download.html"
                                        class="nav-link text-light">技术下载</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown text-md-center active"><a data-toggle="dropdown" href="login.html"
                                class="nav-link text-dark">登录
                                <small class="d-none text-center">login</small>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="dropdown-item"><a href="login.html" class="nav-link text-light">登录</a>
                                </li>
                                <li class="dropdown-item"><a href="reg.html" class="nav-link text-light">注册</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    <div class="container-fluid user px-0 mx-0">
        <div class="container">
            <div class="row">
                <div class="reg col-12 col-lg-6 offset-lg-6">
                    <div class="row">
                        <p class="h6 col-sm-3 col-xs-5 pl-3">新用户注册</p>
                        <p class="col-sm-6 col-xs-5 text-right"><small><a href="login.html">直接登录</a></small></p>
                        <p class="col-sm-2"></p>
                    </div>
                    <div class="row my-sm-2">
                        <p class="left h6 mt-2 col-sm-2 col-xs-4 px-0 mx-0">用户名：</p>
                        <p class="col-sm-6 col-xs-7">
                            <input id="uname" type="text" class=" form-control py-1" placeholder="请输入用户名">
                        </p>
                        <span></span>
                    </div>
                    <div class="row my-sm-2">
                        <p class="left h6 mt-2  col-sm-2 col-xs-4 px-0 mx-0">登录密码：</p>
                        <p class="col-sm-6 col-xs-7">
                            <input id="upwd" type="password" maxlength="12" class=" form-control py-1"
                                placeholder="请输入密码">
                        </p>
                        <span></span>
                    </div>
                    <div class="row my-sm-2">
                        <p class="left h6 mt-2  col-sm-2 col-xs-4 px-0 mx-0">确认密码：</p>
                        <p class="col-sm-6 col-xs-7">
                            <input id="repwd" type="password" maxlength="12" class=" form-control py-1"
                                placeholder="请确认密码">
                        </p>
                        <span></span>
                    </div>
                    <div class="row my-sm-2">
                        <p class="left h6 mt-2  col-sm-2 col-xs-4 px-0 mx-0">邮箱：</p>
                        <p class="col-sm-6 col-xs-7">
                            <input id="email" type="text" class=" form-control py-1" placeholder="请输入邮箱地址">
                        </p>
                        <span></span>
                    </div>
                    <div class="row my-sm-2">
                        <p class="left h6 mt-2  col-sm-2 col-xs-4 px-0 mx-0">手机号：</p>
                        <p class="col-sm-6 col-xs-7">
                            <input id="phone" type="text" class=" form-control py-1" placeholder="请输入您的手机号">
                        </p>
                        <span></span>
                    </div>
                    <div class="row my-sm-2">
                        <p class=" col-xs-4"></p>
                        <p class="col-sm-6 offset-sm-2 col-xs-7"><a class="view">提交注册信息</a></p>
                        <p class="col-sm-3"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <iframe src="../footer.html" frameborder="0" scrolling="no" width="100%" class="ifram_footer"></iframe>
    </footer>
    <script>
        //用户注册表单验证
        //用户名验证
        var testuname = document.getElementById("uname");
        testuname.focus();
        testuname.onfocus = function () {
            var span = this.parentNode.nextElementSibling;
            span.className = "show_msg warn";
            span.innerHTML = "用户名长度在3~9位之间";
        }
        testuname.onblur = function () {
            var span = this.parentNode.nextElementSibling;
            if (this.value == "") {
                span.className = "show_msg err";
                span.innerHTML = "用户名不能为空";
            } else if (/^\w{3,9}$/.test(this.value)) {
                var $uname = uname.value;
                var xhr = new XMLHttpRequest();
                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        var result = xhr.responseText;
                        if (result == '1') {
                            span.className = "show_msg suc";
                            span.innerHTML = "用户名可以使用";
                        } else {
                            span.className = "show_msg err";
                            span.innerHTML = "用户名被占用";
                        }
                    }
                }
                xhr.open("post", "http://127.0.0.1:8080/user/reg_name", true);
                var formdata = "uname=" + $uname;
                xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded")
                xhr.send(formdata);
            } else {
                span.className = "show_msg err";
                span.innerHTML = "用户名长度在3~9位之间";
            }
        }
        //密码验证
        var testpwd = document.getElementById("upwd");
        testpwd.onfocus = function () {
            var span = this.parentNode.nextElementSibling;
            span.className = "show_msg warn";
            span.innerHTML = "密码长度在6~12位之间";
        }
        testpwd.onblur = function () {
            var span = this.parentNode.nextElementSibling;
            if (this.value == "") {
                span.className = "show_msg err";
                span.innerHTML = "密码不能为空";
            } else if (/^\w{6,12}$/.test(this.value)) {
                span.className = "show_msg suc";
                span.innerHTML = "密码格式正确";
            } else {
                span.className = "show_msg err";
                span.innerHTML = "密码长度不能少于6位";
            }
        }
        //确认密码验证
        var testrepwd = document.getElementById("repwd");
        testrepwd.onfocus = function () {
            var span = this.parentNode.nextElementSibling;
            span.className = "show_msg warn";
            span.innerHTML = "请重新输入密码";
        }
        testrepwd.onblur = function () {
            var span = this.parentNode.nextElementSibling;
            if (this.value == "") {
                span.className = "show_msg err";
                span.innerHTML = "密码不能为空";
            } else if (/^\w{6,12}$/.test(this.value)) {
                if (this.value == testpwd.value) {
                    span.className = "show_msg suc";
                    span.innerHTML = "两次输入的密码一致";
                } else {
                    span.className = "show_msg err";
                    span.innerHTML = "两次输入的密码不一致";
                }
            } else {
                span.className = "show_msg err";
                span.innerHTML = "密码长度不能少于6位";
            }
        }
        //邮箱验证
        var testemail = document.getElementById("email");
        testemail.onfocus = function () {
            var span = this.parentNode.nextElementSibling;
            span.className = "show_msg warn";
            span.innerHTML = "请输入合法的邮箱地址";
        }
        testemail.onblur = function () {
            var span = this.parentNode.nextElementSibling;
            if (this.value == "") {
                span.className = "show_msg err";
                span.innerHTML = "邮箱不能为空";
            } else if (/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/.test(this.value)) {
                span.className = "show_msg suc";
                span.innerHTML = "该邮箱可以使用";
            } else {
                span.className = "show_msg err";
                span.innerHTML = "邮箱格式不正确";
            }
        }
        //手机验证
        var testphone = document.getElementById("phone");
        testphone.onfocus = function () {
            var span = this.parentNode.nextElementSibling;
            span.className = "show_msg warn";
            span.innerHTML = "请输入合法的手机号";
        }
        testphone.onblur = function () {
            var span = this.parentNode.nextElementSibling;
            if (this.value == "") {
                span.className = "show_msg err";
                span.innerHTML = "手机号不能为空";
            } else if (/^[1][3,4,5,7,8][0-9]{9}$/.test(this.value)) {
                span.className = "show_msg suc";
                span.innerHTML = "该电话可以使用";
            } else {
                span.className = "show_msg err";
                span.innerHTML = "手机号格式不正确";
            }
        }
        //注册提交
        var reg = document.querySelector(".reg .view");
        reg.onclick = function () {
            var spans = document.querySelectorAll(".reg span");
            for (var span of spans) {
                if (span.className != "show_msg suc") {
                    var bool = false;
                    break;
                }
            }
            if (bool != false) {
                var $uname = uname.value;
                var $upwd = upwd.value;
                var $email = email.value;
                var $tel = phone.value;
                var xhr = new XMLHttpRequest();
                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        var result = xhr.responseText;
                        alert('注册成功')
                        location.href = "http://127.0.0.1:8080/project/user/login.html"
                    }
                }
                xhr.open('post', "http://127.0.0.1:8080/user/reg", true);
                var formdata = "uname=" + $uname + "&upwd=" + $upwd + "&email=" + $email + "&phone=" + $tel;
                xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded")
                xhr.send(formdata);
            }
        }
    </script>
</body>

</html>